(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();let score=0,currentStreak=0,highestStreak=0,questionsAttempted=0,correctAnswers=0,currentQuestion={},timeRemaining=30,maxTime=60,timerInterval,timerStarted=!1,gameOver=!1,currentStage=1,stageThresholds=[0,20,50,80,140,250,400,680,970,1500,2860],newButtonCooldown=!1,cooldownDuration=5,cooldownRemaining=0,cooldownInterval,stageUpNotification,freezeTimeItems=1,showAnswerItems=1,maxPowerupItems=5,powerupDropChance=.2,powerupDropThreshold=3;const questionElement=document.getElementById("question"),answerInput=document.getElementById("answer"),submitBtn=document.getElementById("submit-btn"),newBtn=document.getElementById("new-btn"),scoreElement=document.getElementById("score"),streakElement=document.getElementById("streak"),feedbackElement=document.getElementById("feedback"),attemptedElement=document.getElementById("attempted"),correctElement=document.getElementById("correct"),accuracyElement=document.getElementById("accuracy"),highestStreakElement=document.getElementById("highest-streak");let freezeTimeBtn=document.getElementById("freeze-time-btn"),showAnswerBtn=document.getElementById("show-answer-btn");function initializePowerUps(){const r=document.createElement("div");r.className="flex flex-nowrap justify-center gap-2 items-center mt-4 mb-6",r.innerHTML=`
        <div class="flex items-center">
            <button id="freeze-time-btn" class="px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center">
                <i class="fas fa-snowflake mr-1"></i> Freeze Time
                <span id="freeze-time-count" class="ml-1 bg-blue-700 px-2 py-0.5 rounded-full text-xs">${freezeTimeItems}</span>
            </button>
        </div>
        <div class="flex items-center">
            <button id="show-answer-btn" class="px-3 py-1 bg-purple-500 text-white rounded-md hover:bg-purple-600 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center">
                <i class="fas fa-lightbulb mr-1"></i> Show Answer
                <span id="show-answer-count" class="ml-1 bg-purple-700 px-2 py-0.5 rounded-full text-xs">${showAnswerItems}</span>
            </button>
        </div>
    `;const e=document.querySelector(".flex.justify-between.items-center.mb-6");e.parentNode.insertBefore(r,e),freezeTimeBtn=document.getElementById("freeze-time-btn"),showAnswerBtn=document.getElementById("show-answer-btn"),updatePowerupButtons(),freezeTimeBtn.addEventListener("click",useFreezeTime),showAnswerBtn.addEventListener("click",useShowAnswer)}function updatePowerupButtons(){document.getElementById("freeze-time-count").textContent=freezeTimeItems,document.getElementById("show-answer-count").textContent=showAnswerItems,freezeTimeBtn.disabled=freezeTimeItems<=0||gameOver,showAnswerBtn.disabled=showAnswerItems<=0||gameOver}function checkForPowerupDrop(){if(currentStage<powerupDropThreshold)return;let r=powerupDropChance+currentStage*.02+currentStreak*.01;r=Math.min(r,.7),Math.random()<r&&(Math.random()<.5&&freezeTimeItems<maxPowerupItems?(freezeTimeItems++,showPowerupAnimation("freeze-time")):showAnswerItems<maxPowerupItems?(showAnswerItems++,showPowerupAnimation("show-answer")):freezeTimeItems<maxPowerupItems&&(freezeTimeItems++,showPowerupAnimation("freeze-time")),updatePowerupButtons())}function showPowerupAnimation(r){const e=document.createElement("div");r==="freeze-time"?(e.className="fixed top-20 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-bounce",e.innerHTML='<i class="fas fa-snowflake mr-2"></i> Freeze Time power-up acquired!'):(e.className="fixed top-20 left-1/2 transform -translate-x-1/2 bg-purple-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-bounce",e.innerHTML='<i class="fas fa-lightbulb mr-2"></i> Show Answer power-up acquired!'),document.body.appendChild(e),setTimeout(()=>{e.remove()},2e3)}function useFreezeTime(){if(freezeTimeItems<=0||gameOver)return;freezeTimeItems--,updatePowerupButtons(),clearInterval(timerInterval),timerInterval=null;const r=document.createElement("div");r.className="fixed inset-0 bg-blue-400 opacity-80 bg-opacity-80 z-40 transition-opacity duration-500",document.body.appendChild(r);let e=5;const o=document.createElement("div");o.className="fixed top-3/6 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-6xl font-bold text-blue-700 z-50",o.textContent=e,document.body.appendChild(o),feedbackElement.textContent="Time Frozen! Take your time to solve the question.",feedbackElement.className="text-blue-500 font-bold";const s=setInterval(()=>{e--,o.textContent=e,e<=0&&(clearInterval(s),document.body.removeChild(r),document.body.removeChild(o),gameOver||(startTimer(),feedbackElement.textContent="Time resumes!",feedbackElement.className="text-gray-600"))},1e3)}function useShowAnswer(){if(showAnswerItems<=0||gameOver)return;showAnswerItems--,updatePowerupButtons();const r=document.createElement("div");r.className="fixed top-1/3 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-purple-700 text-white px-8 py-6 rounded-lg shadow-xl z-50 text-center";const e=currentQuestion.answer;r.innerHTML=`
        <div class="text-2xl font-bold mb-2">The answer is:</div>
        <div class="text-4xl font-bold">${e}</div>
        <div class="text-sm mt-4">You can still type it in!</div>
    `,document.body.appendChild(r),answerInput.classList.add("ring-4","ring-purple-400"),answerInput.focus(),setTimeout(()=>{document.body.removeChild(r),answerInput.classList.remove("ring-4","ring-purple-400")},1e3)}document.addEventListener("keydown",r=>{r.code==="KeyA"&&(answerInput.value=currentQuestion.answer,answerInput.classList.add("bg-yellow-100"),setTimeout(()=>answerInput.classList.remove("bg-yellow-100"),1e3))});newBtn.addEventListener("click",()=>{gameOver?resetGame():newButtonCooldown||(startNewButtonCooldown(),generateQuestion())});function startNewButtonCooldown(){newButtonCooldown=!0,cooldownRemaining=cooldownDuration,newBtn.disabled=!0,newBtn.classList.add("opacity-50","cursor-not-allowed"),updateCooldownDisplay(),cooldownInterval=setInterval(()=>{cooldownRemaining--,updateCooldownDisplay(),cooldownRemaining<=0&&(clearInterval(cooldownInterval),newButtonCooldown=!1,newBtn.disabled=!1,newBtn.classList.remove("opacity-50","cursor-not-allowed"),newBtn.innerHTML='New Question <i class="fas fa-redo ml-2"></i>')},1e3)}function updateCooldownDisplay(){newBtn.innerHTML=`New Question (${cooldownRemaining}s) <i class="fas fa-hourglass-half ml-2"></i>`}function resetGame(){timerInterval&&(clearInterval(timerInterval),timerInterval=null),newButtonCooldown&&(clearInterval(cooldownInterval),newButtonCooldown=!1),document.body.classList.remove("stage-11-active"),score=0,currentStreak=0,highestStreak=0,questionsAttempted=0,correctAnswers=0,timeRemaining=30,timerStarted=!1,gameOver=!1,currentStage=1,freezeTimeItems=1,showAnswerItems=1,scoreElement.textContent=score,streakElement.textContent=currentStreak,attemptedElement.textContent=questionsAttempted,correctElement.textContent=correctAnswers,accuracyElement.textContent="0%",highestStreakElement.textContent=highestStreak,document.getElementById("current-stage").textContent=currentStage,updatePowerupButtons(),newBtn.innerHTML='New Question <i class="fas fa-redo ml-2"></i>',newBtn.classList.remove("bg-green-600","hover:bg-green-700","opacity-50","cursor-not-allowed"),newBtn.classList.add("bg-gray-600","hover:bg-gray-700"),newBtn.disabled=!1,answerInput.disabled=!1,submitBtn.disabled=!1,document.getElementById("stage-image").classList.add("hidden"),questionElement.classList.remove("text-red-600","animate-pulse");const e=questionElement.querySelector("div");e&&e.remove(),generateQuestion()}function checkStageProgression(){const r=currentStage;for(let e=stageThresholds.length-1;e>=0;e--)if(score>=stageThresholds[e]){currentStage=e+1;break}if(currentStage>r){if(stageUpNotification=document.createElement("div"),currentStage===11){document.body.classList.add("stage-11-active"),stageUpNotification.className="fixed top-10 left-1/2 transform -translate-x-1/2 bg-red-700 text-white px-8 py-4 rounded-lg shadow-xl z-50 animate-pulse text-lg font-bold",stageUpNotification.innerHTML="⚠️ IMPOSSIBLE MODE UNLOCKED ⚠️<br>Stage 11 Activated!";const e=document.querySelector(".container");e.classList.add("shake"),setTimeout(()=>e.classList.remove("shake"),1e3)}else stageUpNotification.className="fixed top-10 left-1/2 transform -translate-x-1/2 bg-purple-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-bounce",stageUpNotification.textContent=`Stage Up! Now at Stage ${currentStage}`;document.body.appendChild(stageUpNotification),document.getElementById("current-stage").textContent=currentStage,setTimeout(()=>{stageUpNotification.remove()},2e3)}}function generateQuestion(){if(!gameOver){switch(feedbackElement.textContent="",answerInput.value="",answerInput.focus(),checkStageProgression(),currentStage){case 1:generateStage1Question();break;case 2:generateStage2Question();break;case 3:generateStage3Question();break;case 4:generateStage4Question();break;case 5:generateStage5Question();break;case 6:generateStage6Question();break;case 7:generateStage7Question();break;case 8:generateStage8Question();break;case 9:generateStage9Question();break;case 10:generateStage10Question();break;case 11:generateStage11Question();break}timerStarted?(clearInterval(timerInterval),startTimer()):updateTimerDisplay()}}function generateStage1Question(){const operations=["+","-"],operation=operations[Math.floor(Math.random()*operations.length)];let num1,num2;operation==="+"?(num1=Math.floor(Math.random()*25)+1,num2=Math.floor(Math.random()*25)+1):(num1=Math.floor(Math.random()*25)+5,num2=Math.floor(Math.random()*num1)+1),currentQuestion={expression:`${num1} ${operation} ${num2}`,answer:eval(`${num1} ${operation} ${num2}`)},questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage2Question(){const operations=["+","-"],operation=operations[Math.floor(Math.random()*operations.length)];let num1,num2;operation==="+"?(num1=Math.floor(Math.random()*90)+10,num2=Math.floor(Math.random()*90)+10):(num1=Math.floor(Math.random()*90)+25,num2=Math.floor(Math.random()*num1)+1),currentQuestion={expression:`${num1} ${operation} ${num2}`,answer:eval(`${num1} ${operation} ${num2}`)},questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage3Question(){if(Math.random()<.6){const e=Math.floor(Math.random()*10)+2,o=Math.floor(Math.random()*10)+2;currentQuestion={expression:`${e} * ${o}`,answer:e*o}}else{const e=Math.floor(Math.random()*10)+2,o=Math.floor(Math.random()*10)+1;currentQuestion={expression:`${e*o} / ${e}`,answer:o}}questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage4Question(){const ops=["+","-"],op1=ops[Math.floor(Math.random()*ops.length)],op2=ops[Math.floor(Math.random()*ops.length)];let num1=Math.floor(Math.random()*25)+10,num2=Math.floor(Math.random()*20)+5,num3=Math.floor(Math.random()*25)+5;op1==="-"&&num2>num1&&([num1,num2]=[num2,num1]);let tempResult=eval(`${num1} ${op1} ${num2}`);op2==="-"&&num3>tempResult&&(op2="+");const expression=`${num1} ${op1} ${num2} ${op2} ${num3}`;currentQuestion={expression,answer:eval(expression)},questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage5Question(){const operations=["+","-","*"],questionType=Math.random();if(questionType<.5){const operation=operations[Math.floor(Math.random()*operations.length)];let num1,num2;operation==="+"?(num1=Math.floor(Math.random()*30)+20,num2=Math.floor(Math.random()*30)+10):operation==="-"?(num1=Math.floor(Math.random()*50)+30,num2=Math.floor(Math.random()*(num1-5))+5):(num1=Math.floor(Math.random()*12)+4,num2=Math.floor(Math.random()*12)+3),currentQuestion={expression:`${num1} ${operation} ${num2}`,answer:eval(`${num1} ${operation} ${num2}`)}}else{const num1=Math.floor(Math.random()*20)+10,num2=Math.floor(Math.random()*10)+2,num3=Math.floor(Math.random()*8)+2,patterns=[`${num1} + ${num2} * ${num3}`,`${num1} * ${num2} + ${num3}`],expression=patterns[Math.floor(Math.random()*patterns.length)];currentQuestion={expression,answer:eval(expression)}}questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage6Question(){const operations=["+","-","*"],op1=operations[Math.floor(Math.random()*operations.length)];let op2=operations[Math.floor(Math.random()*operations.length)],op3=operations[Math.floor(Math.random()*operations.length)],num1=Math.floor(Math.random()*15)+10,num2=Math.floor(Math.random()*10)+5,num3=Math.floor(Math.random()*10)+5,num4=Math.floor(Math.random()*8)+3;op1==="-"&&num2>num1&&([num1,num2]=[num2,num1]);let expression=`${num1} ${op1} ${num2}`,tempResult=eval(expression);op2==="-"&&tempResult<num3&&(op2="+"),expression=`${expression} ${op2} ${num3}`,tempResult=eval(expression),op3==="-"&&tempResult<num4&&(op3="+"),expression=`${expression} ${op3} ${num4}`,currentQuestion={expression,answer:eval(expression)},questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage7Question(){const r=["+","-","*"];if(Math.random()<.6){const o=r[Math.floor(Math.random()*r.length)],s=r[Math.floor(Math.random()*r.length)];let t=Math.floor(Math.random()*15)+8,n=Math.floor(Math.random()*8)+3,a=Math.floor(Math.random()*10)+4;o==="-"&&n>t&&([t,n]=[n,t]);let i=`(${t} ${o} ${n}) ${s} ${a}`,l;switch(o){case"+":l=t+n;break;case"-":l=t-n;break;case"*":l=t*n;break}let m;switch(s){case"+":m=l+a;break;case"-":m=l-a;break;case"*":m=l*a;break}m<0&&s==="-"&&(s="+",i=`(${t} ${o} ${n}) ${s} ${a}`,m=l+a),currentQuestion={expression:i,answer:m}}else{const o=r[Math.floor(Math.random()*r.length)],s=r[Math.floor(Math.random()*r.length)];let t=Math.floor(Math.random()*20)+5,n=Math.floor(Math.random()*22)+5,a=Math.floor(Math.random()*15)+2;o==="-"&&a>n&&([n,a]=[a,n]);let i;switch(o){case"+":i=n+a;break;case"-":i=n-a;break;case"*":i=n*a;break}let l,m;s==="-"?i>t?(l=`(${n} ${o} ${a}) - ${t}`,m=i-t):(l=`${t} - (${n} ${o} ${a})`,m=t-i):s==="+"?(l=`${t} + (${n} ${o} ${a})`,m=t+i):(l=`${t} * (${n} ${o} ${a})`,m=t*i),currentQuestion={expression:l,answer:m}}questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage8Question(){const r=Math.random();if(r<.4){const e=Math.floor(Math.random()*5)+2,o=Math.floor(Math.random()*2)+2;currentQuestion={expression:`${e}^${o}`,answer:Math.pow(e,o)}}else if(r<.7){const e=Math.floor(Math.random()*4)+2,o=2,s=Math.floor(Math.random()*15)+5;currentQuestion={expression:`${e}^${o} + ${s}`,answer:Math.pow(e,o)+s}}else{const e=Math.floor(Math.random()*5)+2,o=Math.floor(Math.random()*5)+2,s=e*o,t=Math.floor(Math.random()*10)+5;currentQuestion={expression:`${t} * (${s} / ${e})`,answer:t*o}}questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage9Question(){const r=Math.random();if(r<.33){const e=Math.floor(Math.random()*25)+5,o=Math.floor(Math.random()*20)+5,s=Math.floor(Math.random()*15)+3,t=Math.floor(Math.random()*12)+2,n=Math.floor(Math.random()*10)+2;currentQuestion={expression:`${e} * ((${o} + ${s}) * (${t} + ${n}))`,answer:e*((o+s)*(t+n))}}else if(r<.66){const e=Math.floor(Math.random()*22)+3,o=Math.floor(Math.random()*20)+3,s=Math.floor(Math.random()*15)+2,t=Math.floor(Math.random()*12)+2,n=Math.floor(Math.random()*10)+2,a=Math.floor(Math.random()*8)+2,i=`(${e} * ${o} + ${s}) - (${t} * ${n} - ${a})`;let l=e*o+s,m=t*n-a,u=l-m;if(u<0){const c=`(${e} * ${o} + ${s}) + (${t} * ${n} - ${a})`;u=l+m,currentQuestion={expression:c,answer:u}}else currentQuestion={expression:i,answer:u}}else{const e=Math.floor(Math.random()*15)+5,o=Math.floor(Math.random()*12)+3,s=Math.floor(Math.random()*10)+2,t=Math.floor(Math.random()*8)+2,n=Math.floor(Math.random()*6)+2;let a=t-n;a<0&&([t,n]=[n,t],a=n-t);let i=s*a,l=o+i,m=e*l;currentQuestion={expression:`${e} * (${o} + ${s} * (${Math.max(t,n)} - ${Math.min(t,n)}))`,answer:m}}questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage10Question(){const r=Math.random();if(r<.25){const e=Math.floor(Math.random()*5)+2,o=Math.floor(Math.random()*2)+2,s=Math.floor(Math.random()*4)+2,t=Math.floor(Math.random()*2)+2,n=Math.floor(Math.random()*3)+2,a=2,i=`${e}^${o} + ${s}^${t} * ${n}^${a}`,l=Math.pow(e,o)+Math.pow(s,t)*Math.pow(n,a);currentQuestion={expression:i,answer:l}}else if(r<.5){const e=Math.floor(Math.random()*5)+3;let o=1;for(let m=2;m<=e;m++)o*=m;const s=Math.floor(Math.random()*3)+2;let t=1;for(let m=2;m<=s;m++)t*=m;const n=["+","*"],a=n[Math.floor(Math.random()*n.length)],i=`${e}! ${a} ${s}!`;let l;a==="+"?l=o+t:l=o*t,currentQuestion={expression:i,answer:l}}else if(r<.75){const e=Math.floor(Math.random()*4)+2,o=2,s=Math.floor(Math.random()*15)+5,t=Math.floor(Math.random()*3)+2,n=2,a=Math.floor(Math.random()*10)+5,i=`(${e}^${o} * ${s}) - (${t}^${n} * ${a})`,l=Math.pow(e,o)*s,m=Math.pow(t,n)*a;l>=m?currentQuestion={expression:i,answer:l-m}:currentQuestion={expression:`(${t}^${n} * ${a}) - (${e}^${o} * ${s})`,answer:m-l}}else{const e=Math.floor(Math.random()*5)+3,o=Math.floor(Math.random()*10)+5,s=Math.floor(Math.random()*12)+3,t=Math.floor(Math.random()*8)+2,n=Math.pow(e,2),a=o+s;let i=t,l=n*a;if(l%i!==0){for(let c=2;c<=Math.min(15,l);c++)if(l%c===0){i=c;break}}const m=`${e}^2 * (${o} + ${s}) / ${i}`,u=n*a/i;currentQuestion={expression:m,answer:u}}questionElement.textContent=`${currentQuestion.expression} = ?`}function generateStage11Question(){const questionType=Math.random();if(questionType<.25){const r=Math.floor(Math.random()*10)+5,e=Math.floor(Math.random()*2)+2,o=Math.floor(Math.random()*5)+2,s=Math.pow(r,e);let t=o;for(let i=2;i<=10;i++)if(s%i===0){t=i;break}const n=Math.floor(s/t),a=Math.floor(Math.random()*500)+100;currentQuestion={expression:`${r}^${e} / ${t} + ${a}`,answer:n+a}}else if(questionType<.5){const num1=Math.floor(Math.random()*400)+600,num2=Math.floor(Math.random()*200)+200,num3=Math.floor(Math.random()*100)+200,num4=Math.floor(Math.random()*100)+50;let step1=num1-num2;step1<0&&([num1,num2]=[num2,num1],step1=num2-num1);let step2=step1+num3;if(step2<num4){const expression=`${num1} - ${num2} + ${num3} + ${num4}`;currentQuestion={expression,answer:eval(expression)}}else{const expression=`${num1} - ${num2} + ${num3} - ${num4}`;currentQuestion={expression,answer:eval(expression)}}}else if(questionType<.75){const r=Math.floor(Math.random()*4)+3,e=Math.floor(Math.random()*2)+2,o=Math.floor(Math.random()*3)+2,s=Math.floor(Math.random()*2)+2,t=Math.pow(r,e)+Math.pow(o,s);let n=1;for(let a=2;a<=Math.min(10,t);a++)if(t%a===0){n=a;break}currentQuestion={expression:`(${r}^${e} + ${o}^${s}) / ${n}`,answer:t/n}}else{const r=Math.floor(Math.random()*5)+5,e=2,o=Math.floor(Math.random()*5)+3,s=Math.floor(Math.random()*200)+300,t=Math.floor(Math.random()*100)+100,n=Math.pow(r,e)*o;if(n+s>t){const a=`(${r}^${e} * ${o}) + ${s} - ${t}`,i=n+s-t;currentQuestion={expression:a,answer:i}}else{const a=`(${r}^${e} * ${o}) + ${s} + ${t}`,i=n+s+t;currentQuestion={expression:a,answer:i}}}questionElement.textContent=`${currentQuestion.expression} = ?`,questionElement.classList.add("text-red-600");const warningElement=document.createElement("div");warningElement.className="text-sm text-red-500 font-bold mt-2",warningElement.textContent="⚠️ IMPOSSIBLE LEVEL ⚠️",questionElement.appendChild(warningElement),questionElement.classList.add("animate-pulse"),setTimeout(()=>{questionElement.classList.remove("animate-pulse")},2e3)}function startTimer(){updateTimerDisplay(),timerInterval=setInterval(()=>{timeRemaining-=.1,timeRemaining<=0&&(timeRemaining=0,clearInterval(timerInterval),handleTimeUp()),updateTimerDisplay()},100)}function updateTimerDisplay(){const r=document.getElementById("time-display"),e=document.getElementById("timer-bar");r.textContent=`${Math.round(timeRemaining)}s`;const o=currentStage===11?Math.min(30,maxTime):maxTime;let s=timeRemaining/o*100;s=Math.min(s,100),e.style.width=`${s}%`,timeRemaining<10?(e.classList.remove("bg-purple-500","bg-yellow-500"),e.classList.add("bg-red-500")):timeRemaining<20?(e.classList.remove("bg-purple-500","bg-red-500"),e.classList.add("bg-yellow-500")):(e.classList.remove("bg-red-500","bg-yellow-500"),e.classList.add("bg-purple-500")),currentStage===11?e.classList.add("animate-pulse"):e.classList.remove("animate-pulse")}function handleTimeUp(){gameOver=!0,currentStreak=0,streakElement.textContent=currentStreak,newButtonCooldown&&(clearInterval(cooldownInterval),newButtonCooldown=!1),feedbackElement.textContent=`Time's up! The answer was ${currentQuestion.answer}`,feedbackElement.className="text-red-500 font-bold",answerInput.disabled=!0,submitBtn.disabled=!0,newBtn.innerHTML='Reset Game <i class="fas fa-sync-alt ml-2"></i>',newBtn.disabled=!1,newBtn.classList.remove("bg-gray-600","hover:bg-gray-700","opacity-50","cursor-not-allowed"),newBtn.classList.add("bg-green-600","hover:bg-green-700"),questionElement.textContent=`Game Over! Final Score: ${score} (Stage ${currentStage})`;const r=document.getElementById("stage-image");r.src=`images/stage ${currentStage}.gif`,r.alt=`Stage ${currentStage} Completion`,r.className="min-w-[250px] max-w-[250px] max-h-[250px] rounded-lg shadow-md mt-5",r.classList.remove("hidden")}function checkAnswer(){if(gameOver)return;const r=parseInt(answerInput.value);if(isNaN(r)){feedbackElement.textContent="Please enter a valid whole number!",feedbackElement.className="text-red-500 font-medium";return}questionsAttempted++,attemptedElement.textContent=questionsAttempted,clearInterval(timerInterval);let e=5;currentStage===11&&(e=50);const o=currentStage,s=Math.floor(currentStreak/3);if(r===currentQuestion.answer){let t=e*o+s;currentStage===11&&(t*=2),score+=t,currentStreak++,correctAnswers++,checkForPowerupDrop(),currentStreak>highestStreak&&(highestStreak=currentStreak,highestStreakElement.textContent=highestStreak);let n=Math.min(8,2+Math.floor(currentStage/2)+Math.floor(currentStreak/4));currentStage===11&&(n=Math.min(15,10+Math.floor(currentStreak/2))),timeRemaining=Math.min(maxTime,timeRemaining+n),currentStage===11?(feedbackElement.textContent=`INCREDIBLE! +${t} points, +${n}s 🔥🔥🔥`,feedbackElement.className="text-green-500 font-bold text-xl",questionElement.classList.add("correct-answer")):(feedbackElement.textContent=`Correct! +${t} points, +${n}s 🎉`,feedbackElement.className="text-green-500 font-bold",questionElement.classList.add("correct-answer")),setTimeout(()=>{questionElement.classList.remove("correct-answer")},800)}else{currentStreak=0;let t=3+Math.floor(currentStage*1.5);if(currentStage===11&&(t=15),timeRemaining=Math.max(0,timeRemaining-t),currentStage===11?(feedbackElement.textContent=`BRUTAL! -${t}s. The answer was ${currentQuestion.answer}`,feedbackElement.className="text-red-600 font-bold text-lg"):(feedbackElement.textContent=`Wrong! -${t}s. The answer was ${currentQuestion.answer}`,feedbackElement.className="text-red-500 font-medium"),questionElement.classList.add("wrong-answer"),setTimeout(()=>{questionElement.classList.remove("wrong-answer")},500),timeRemaining<=0){timeRemaining=0,updateTimerDisplay(),handleTimeUp();return}}scoreElement.textContent=score,streakElement.textContent=currentStreak,correctElement.textContent=correctAnswers,accuracyElement.textContent=Math.round(correctAnswers/questionsAttempted*100)+"%",updateTimerDisplay(),timerStarted&&timeRemaining>0&&!gameOver&&startTimer(),setTimeout(()=>{if(!gameOver){questionElement.classList.remove("text-red-600");const t=questionElement.querySelector("div");t&&t.remove(),generateQuestion()}},500)}document.addEventListener("DOMContentLoaded",()=>{generateQuestion(),initializePowerUps(),submitBtn.addEventListener("click",()=>{gameOver||(timerStarted||(startTimer(),timerStarted=!0),checkAnswer())}),newBtn.addEventListener("click",()=>{gameOver?resetGame():generateQuestion()}),answerInput.addEventListener("keypress",r=>{r.key==="Enter"&&!gameOver&&(timerStarted||(startTimer(),timerStarted=!0),checkAnswer())})});
